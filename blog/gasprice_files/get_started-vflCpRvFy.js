// Generated by CoffeeScript 1.3.3
var GetStarted,
  _this = this;

GetStarted = {
  show_mobile_sms_modal: function() {
    return Modal.show(_('Get Dropbox for mobile'), $('gs-mobile-sms-modal'));
  },
  show_mobile_email_modal: function() {
    return Modal.show(_('Get Dropbox for mobile'), $('gs-mobile-email-modal'));
  },
  initialize_v3: function(download_client_link, add_file_link, shared_folder_link) {
    $j('#gs-client').on('click', function() {
      return location.href = download_client_link;
    });
    $j('#gs-add-files').on('click', function() {
      return location.href = add_file_link;
    });
    $j('#gs-share-folder').on('click', function() {
      return location.href = shared_folder_link;
    });
    $j('#gs-mobile-send-sms').on('click', function() {
      $j('#sms-send-button-inprogress').hide();
      $j('#sms-send-form').show();
      $j('#sms-send-success').hide();
      return Modal.show(_('Get Dropbox for mobile'), $j('#gs-mobile-sms-modal')[0]);
    });
    $j('#gs-mobile-sms-send-button').on('click', function() {
      return GetStarted.send_text();
    });
    $j('#sms-send-form').on('submit', function() {
      event.preventDefault();
      return GetStarted.send_text();
    });
    $j('#gs-mobile-send-email').on('click', function() {
      $j('#email-send-button-inprogress').hide();
      $j('#email-send-form').show();
      $j('#email-send-success').hide();
      return Modal.show(_('Get Dropbox for mobile'), $j('#gs-mobile-email-modal')[0]);
    });
    $j('#gs-mobile-email-send-button').on('click', function() {
      return GetStarted.send_email();
    });
    $j('#email-send-form').on('submit', function(event) {
      event.preventDefault();
      return GetStarted.send_email();
    });
    Util.freshbutton_overlay($j('#gs-client'), $j('#gs-client .show-me-how a'));
    Util.freshbutton_overlay($j('#gs-add-files'), $j('#gs-add-files .show-me-how a'));
    return Util.freshbutton_overlay($j('#gs-share-folder'), $j('#gs-share-folder .show-me-how a'));
  },
  reset_email_form: function() {
    $j('#email-send-button').show();
    return $j('#email-send-button-inprogress').hide();
  },
  send_email: function() {
    var form;
    $j('#email-send-button-inprogress').show();
    $j('#email-send-button').hide();
    setTimeout(_this.reset_email_form, 4000);
    form = $j('#email-send-form')[0];
    return Forms.ajax_submit(form, '/email_mobile_app', (function(resp) {
      $j('#email-send-success').show();
      return $j('#email-send-form').hide();
    }), (function(resp) {
      return _this.reset_email_form();
    }));
  },
  reset_text_form: function() {
    $j('#sms-send-button').show();
    return $j('#sms-send-button-inprogress').hide();
  },
  send_text: function() {
    var form;
    $j('#sms-send-button').hide();
    $j('#sms-send-button-inprogress').show();
    setTimeout(_this.reset_text_form, 4000);
    form = $j('#sms-send-form')[0];
    return Forms.ajax_submit(form, '/text_mobile_app', (function(resp) {
      $j('#sms-send-form').hide();
      return $j('#sms-send-success').show();
    }), (function(resp) {
      return _this.reset_text_form();
    }));
  },
  display_start_bubble: function(title, body, bubble_container, width, tail_side, tail_position) {
    var bubble_dom, button_handler, button_text, classname, close_handler;
    if (tail_side == null) {
      tail_side = "top";
    }
    if (tail_position == null) {
      tail_position = "center";
    }
    button_text = null;
    button_handler = null;
    classname = null;
    close_handler = null;
    bubble_dom = NavBubble.make(title, body, button_text, button_handler, classname, close_handler, tail_side, tail_position, width, {
      hide_x: true,
      hide_button: true
    });
    return bubble_container.__date(bubble_dom);
  },
  shared_folder_reset: function() {
    $j('#shared_folder_get_started_action_container').removeClass('visible_state');
    return $j('#get_started_result_container').removeClass('visible_state');
  },
  shared_folder_start: function() {
    var body, bubble_container, title, width;
    GetStarted.shared_folder_reset();
    title = _('Share a folder and earn 250MB!');
    body = _('Share a folder to collaborate with a friend or coworker on the same files.');
    bubble_container = $j('#shared_folder_get_started_action_bubble')[0];
    width = 400;
    GetStarted.display_start_bubble(title, body, bubble_container, width);
    $j('#shared_folder_get_started_action_container').addClass('visible_state');
    return document.observe(FileEvents.SF_NEW, (function() {
      GetStarted.shared_folder_reset();
      return GetStarted.step_finish();
    }));
  },
  step_finish: function() {
    var body, bubble_container, title, width;
    title = _('Nice work! You earned an extra 250MB.');
    body = _('To earn even more space, continue Get Started.');
    bubble_container = $j('#get_started_result_bubble')[0];
    width = 325;
    GetStarted.display_start_bubble(title, body, bubble_container, width, "left", "middle");
    return $j('#get_started_result_container').addClass('visible_state');
  },
  add_files_reset: function() {
    $j('#add_files_get_started_action_container').removeClass('visible_state');
    return $j('#get_started_result_container').removeClass('visible_state');
  },
  add_files_start: function() {
    var body, bubble_container, title, width;
    GetStarted.add_files_reset();
    title = _('Add your stuff and earn 250MB!');
    body = _('Click here to add files, or drag them into the Dropbox folder on your Desktop.');
    width = 300;
    bubble_container = $j('#add_files_get_started_action_bubble')[0];
    GetStarted.display_start_bubble(title, body, bubble_container, width);
    $j('#add_files_get_started_action_container').addClass('visible_state');
    return document.observe(Upload.COMPLETE_EVT, (function() {
      GetStarted.add_files_reset();
      return GetStarted.step_finish();
    }));
  }
};
